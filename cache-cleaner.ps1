$du_before = Get-PSDrive C
Write-Output ":: Cleaning..."
Write-Output " (1/35) Cleaning Windows Events"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\system32\winevt\Logs"
Write-Output " (2/35) Cleaning Windows Logs"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\*.log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\*.bak"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\*log.txt"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\SchedLgU.txt"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\Performance\WinSAT\*.log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\Panther\*.log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\Microsoft\Windows\*.log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\MigWiz\*.log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\Microsoft\CLR_*\*.log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\Microsoft\CLR_*\*\*.log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Roaming\Microsoft\Windows\*.log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Logs"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\Logs"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\Performance\WinSAT\DataStore"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SYSTEMDRIVE\System Volume Information\Chkdsk"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:ProgramData\USOShared\Logs"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\system32\WDI\LogFiles\*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\system32\LogFiles\*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\debug"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Users\*\AppData\Local\Packages\*\AC\Microsoft\CLR_*\*.log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Users\*\AppData\Local\Packages\*\AC\#!*\Microsoft\CLR_*\*.log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Users\*\AppData\Local\Packages\*\AC\Microsoft\CLR_*\*\*.log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Users\*\AppData\Local\Packages\*\AC\#!*\Microsoft\CLR_*\*\*.log"
Write-Output " (3/35) Cleaning Windows Reports"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\Microsoft\Windows\WER"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:ProgramData\Microsoft\Windows\WER"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\LiveKernelReports"
Write-Output " (4/35) Cleaning Windows download cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\SoftwareDistribution\Download"
Write-Output " (5/35) Cleaning Windows Delivery Optimization cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\SoftwareDistribution\DeliveryOptimization"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\DeliveryOptimization"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\ServiceProfiles\NetworkService\AppData\Local\Microsoft\Windows\DeliveryOptimization"
Write-Output " (9/35) Cleaning WinSxS cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\WinSxS\ManifestCache"
Write-Output " (10/35) Cleaning cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:Temp"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Found.*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Users\*\AppData\Local\Packages\*\AC\Temp\*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Users\*\AppData\Local\Packages\*\AC\#!*\Temp\*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\ServiceProfiles\*\AppData\Local\Temp\*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\system32\config\systemprofile\AppData\Local\Temp\*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Windows\SysWOW64\config\systemprofile\AppData\Local\Temp\*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\Temp"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Users\*\AppData\Local\Packages\*\AC\Temp\*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Users\*\AppData\Local\Packages\*\AC\#!*\Temp\*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\ServiceProfiles\*\AppData\Local\Temp\*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\system32\config\systemprofile\AppData\Local\Temp"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Windows\SysWOW64\config\systemprofile\AppData\Local\Temp"
Write-Output " (11/35) Cleaning Windows crash dump files"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\appdata\local\crashdumps"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\MEMORY.DMP"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemRoot\Minidump"
Write-Output " (12/35) Cleaning driver install cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\AMD"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Intel"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\NVIDIA"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Prog"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\SWSetup"
Write-Output " (13/35) Cleaning Windows UUP update cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\$Windows.~BT"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\$Windows.~WS"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\$Windows.~LS"
Write-Output " (14/35) Cleaning Windows Search cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\ProgramData\Microsoft\Search\Data\Applications\Windows"
Write-Output " (15/35) Cleaning pip download cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\pip\cache"
Write-Output " (16/35) Cleaning ~\.cache (torch, huggingface, paddle, etc.)"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\.cache"
Write-Output " (17/35) Cleaning paddlehub downloaded model cache (.paddlehub)"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\.paddlehub"
Write-Output " (18/35) Cleaning IDM download cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Roaming\IDM\DwnlData"
Write-Output " (19/35) Cleaning Steam download cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Program Files (x86)\Steam\steamapps\downloading"
Write-Output " (20/35) Cleaning Tencent QQ cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Roaming\Tencent\AndroidAssist"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Roaming\Tencent\AndroidServer"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Roaming\Tencent\Logs"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Roaming\Tencent\TXSSO"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Users\*\AppData\Roaming\Tencent\Users\*\WinTemp\*"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:SystemDrive\Windows\SysWOW64\config\systemprofile\AppData\Roaming\Tencent"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:ProgramData\temp"
Write-Output " (21/35) Cleaning Tencent WeMeet logs"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:APPDATA\Tencent\WeMeet\Global\Logs"
Write-Output " (22/35) Cleaning Baidu Netdisk cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:APPDATA\BaiduYunKernel\Data"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:APPDATA\BaiduYunGuanjia\logs"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:APPDATA\baidu\BaiduNetdisk\AutoUpdate\Download"
Write-Output " (23/35) Cleaning Process Lasso log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:ProgramData\ProcessLasso\logs\processlasso.log"
Write-Output " (24/35) Cleaning FastCopy log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\FastCopy\Log"
Write-Output " (25/35) Cleaning UltraEdit Restore files"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:APPDATA\IDMComp\UltraEdit\Restore"
Write-Output " (26/35) Cleaning IntelliSense cache of vscode-cpptools"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\Microsoft\vscode-cpptools\*"
Write-Output " (27/35) Cleaning NuGet cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\NuGet\Cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\NuGet\v3-cache"
Write-Output " (28/35) Cleaning VSCode cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:APPDATA\Code\Cache"
Write-Output " (29/35) Cleaning clash and clash for windows logs and cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\.config\clash\logs"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\clash_win-updater"
Write-Output " (30/35) Cleaning WeChat cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\Documents\WeChat Files\wxid_*\FileStorage\Cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\Documents\WeChat Files\wxid_*\Msg\Multi\bak"
Write-Output " (31/35) Cleaning miHoYo games' log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\LocalLow\miHoYo"
Write-Output " (32/35) Cleaning HikariField games' log"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\LocalLow\HikariField"
Write-Output " (33/35) Cleaning Electron Apps' updater"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\*-updater"
Write-Output " (34/35) Cleaning Netease CloudMusic cache"
Remove-Item -Recurse -Force -ErrorAction SilentlyContinue "$env:USERPROFILE\AppData\Local\Netease\CloudMusic\Cache"
Write-Output " (35/35) Cleaning conda cache"
conda clean --all -y
Write-Output " Done."
Write-Output ":: Calculating..."
$du_after = Get-PSDrive C
Write-Output " --> Before:"
Write-Output $du_before
Write-Output "`n --> After:`n"
Write-Output $du_after
